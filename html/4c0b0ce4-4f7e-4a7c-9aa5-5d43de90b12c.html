<!DOCTYPE html>
    <html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
        <title>PleaseUnlockIT</title>
    </head>
    <body>
        <!-- header-bg -->
        <style type="text/css">
            .badge, .badge-timer {
            background-color: #F6F5F2;
            border-radius: .2rem;
            }
            .crypto-amount {
            padding: .1rem;
            border-radius: .3rem;
            background-color: #F6F5F2;
            }
            .qrcode {
            width: 100%;
            text-align: center;
            }
            canvas {
            background-color: #fff;
            border-radius: .3rem;
            padding: 1rem;
            }
            .info {
            padding: 1rem;
            background-color: #F6F5F2;
            border-radius: .4rem;
            }
        </style>
        <div class="wrapper" style="padding-top: 2rem !important">
            <div class="container-fluid">
                <!-- START ROW -->
                    <div class="card m-b-30">
                        <div class="card-body">
                            <h4>
                            <b>QUESTION:</b>
                            <br>
                            </h4>
                            <div class="mb-0" id="info">
                            <div class="row">
                                <div class="col-md-9">
                                    <p>[ASSEMBLY LANGUAGE]<img alt="Ν C:1Windowssystem321cmd.exe
Enter the plain text: It is a plain text string with SSN 586-43-4564, and secret password, 58935" src="https://media.cheggcdn.com/media%2Ffea%2Ffeaba9f4-6f73-4b44-9419-f17d6225e65e%2Fphp3nKENG.png" style="height:405px;width:1024px;"></p>
<p><strong>Message Encryption</strong><br>
Revise the encryption program in Section 6.3.4 in the following
manner: Create an encryption key consisting of multiple characters.
Use this key to encrypt and decrypt the plaintext by XOR-ing each
character of the key against a corresponding byte in the message.
Repeat the key as many times as necessary until all plain text
bytes are translated. Suppose, for example, the key were equal to
“ABXmv#7”. This is how the key would align with the plain text
bytes:</p>
<p>The max-size of the input string and key is, 128</p>

                                </div>

                            </div>
                            </div>
                            <div class="mt-3 invoice-card">

                            <div id="details" class="mt-4 info">
                                <h4>
                                    <b>ANSWER:</b>
                                    <br>
                                </h4>
                                <div class="row">
                                    <div class="col">
                                        <p>INCLUDE Irvine32.inc<br />
KEY = 239 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; any value between
1-255<br />
BUFMAX = 128 &nbsp; &nbsp; &nbsp; &nbsp;; maximum buffer size<br />
.data<br />
ENTERSTRING BYTE "Enter the plain text: ",0<br />
CIPHERED BYTE "Cipher text: &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp;",0<br />
DECIPHERED BYTE "Decrypted: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp;",0<br />
buffer &nbsp; BYTE &nbsp; BUFMAX+1 DUP(0)<br />
bufSize DWORD ?<br />
.code<br />
main PROC<br />
&nbsp; &nbsp; call &nbsp; &nbsp;INPUTSTRING &nbsp; &nbsp; &nbsp;;
input the plain text<br />
&nbsp; &nbsp; call &nbsp; &nbsp;TRANSBUF ; encrypt the buffer<br />
&nbsp; &nbsp; mov edx,OFFSET CIPHERED ; display encrypted
message<br />
&nbsp; &nbsp; call &nbsp; &nbsp;DISPLAYMSG<br />
&nbsp; &nbsp; call &nbsp; &nbsp;TRANSBUF &nbsp; &nbsp; ; decrypt
the buffer<br />
&nbsp; &nbsp; mov edx,OFFSET DECIPHERED ; display decrypted
message<br />
&nbsp; &nbsp; call &nbsp; &nbsp;DISPLAYMSG<br />
&nbsp; &nbsp; exit<br />
main ENDP<br />
&nbsp; &nbsp; pushad<br />
&nbsp; &nbsp; mov edx,OFFSET ENTERSTRING ; display a prompt<br />
&nbsp; &nbsp; call &nbsp; &nbsp;WriteString<br />
&nbsp; &nbsp; mov ecx,BUFMAX &nbsp; &nbsp; &nbsp;; maximum
character count<br />
&nbsp; &nbsp; mov edx,OFFSET buffer &nbsp; ; point to the
buffer<br />
&nbsp; &nbsp; call &nbsp; &nbsp;ReadString &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp;; input the string<br />
&nbsp; &nbsp; mov bufSize,eax &nbsp; &nbsp; &nbsp; &nbsp; ; save
the length<br />
&nbsp; &nbsp; call &nbsp; &nbsp;Crlf<br />
&nbsp; &nbsp; popad<br />
&nbsp; &nbsp; ret<br />
INPUTSTRING ENDP<br />
&nbsp; &nbsp; pushad<br />
&nbsp; &nbsp; call &nbsp; &nbsp;WriteString<br />
&nbsp; &nbsp; mov edx,OFFSET buffer &nbsp; ; display the
buffer<br />
&nbsp; &nbsp; call &nbsp; &nbsp;WriteString<br />
&nbsp; &nbsp; call &nbsp; &nbsp;Crlf<br />
&nbsp; &nbsp; call &nbsp; &nbsp;Crlf<br />
&nbsp; &nbsp; popad<br />
&nbsp; &nbsp; ret<br />
DISPLAYMSG ENDP<br />
&nbsp; &nbsp; pushad<br />
&nbsp; &nbsp; mov ecx,bufSize &nbsp; &nbsp; ; loop counter<br />
&nbsp; &nbsp; mov esi,0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; index
0 in buffer<br />
L1:<br />
&nbsp; &nbsp; xor buffer[esi],KEY ; translate a byte<br />
&nbsp; &nbsp; inc esi &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;
point to next byte<br />
&nbsp; &nbsp; loop &nbsp; &nbsp;L1<br />
&nbsp; &nbsp; popad<br />
&nbsp; &nbsp; ret<br />
TRANSBUF ENDP<br />
END main</p>

                                    </div>
                                </div>
                            </div>
                            </div>
                        </div>
                    </div>

                <!-- END ROW -->

                <!-- end container-fluid -->
            </div>
            <!-- end wrapper -->
        </div>

    </body>
    </html>
    